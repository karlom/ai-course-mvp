import express from 'express';\nimport dotenv from 'dotenv';\nimport bodyParser from 'body-parser';\nimport { Queue } from 'bullmq';\nimport IORedis from 'ioredis';\n\ndotenv.config();\n\nconst app = express();\napp.use(bodyParser.json());\n\nconst redisConnection = new IORedis({\n  host: process.env.REDIS_HOST || 'redis',\n  port: Number(process.env.REDIS_PORT || 6379),\n});\n\nconst generateQueue = new Queue('generate-course', { connection: redisConnection });\n\napp.post('/api/v1/generate_course', async (req, res) => {\n  const payload = req.body;\n  if (!payload.client_name) return res.status(400).json({ error: 'client_name required' });\n\n  // create job in BullMQ; Node worker will consume it\n  const job = await generateQueue.add('generate', { payload }, { attempts: 3 });\n  return res.json({ jobId: job.id });\n});\n\napp.get('/api/v1/jobs/:id', async (req, res) => {\n  const jobId = req.params.id;\n  const job = await generateQueue.getJob(jobId);\n  if (!job) return res.status(404).json({ error: 'job not found' });\n  const state = await job.getState();\n  return res.json({ id: job.id, state, returnvalue: job.returnvalue, progress: job.progress });\n});\n\nconst port = Number(process.env.API_PORT || 3000);\napp.listen(port, () => {\n  console.log(`API server listening on ${port}`);\n});